#!/bin/sh

set -e

name="$1"
if [[ "$name" == "" ]]; then
    echo "name must be provided" 2>&1
    exit 1
fi

case $name in
    "projects")
        url="http://localhost:8000/dendrite/api/projects"
        ;;
    "project")
        id="$2"
        if [[ "$id" == "" ]]; then
            echo "id must be provided" 2>&1
            exit 1
        fi
        url="http://localhost:8000/dendrite/api/projects/$id"
        ;;
    "graphs")
        url="http://localhost:8000/dendrite/api/graphs"
        ;;
    "graph")
        id="$2"
        if [[ "$id" == "" ]]; then
            echo "id must be provided" 2>&1
            exit 1
        fi
        url="http://localhost:8000/dendrite/api/graphs/$id"
        ;;
    "jobs")
        url="http://localhost:8000/dendrite/api/jobs"
        ;;
    "job")
        id="$2"
        if [[ "$id" == "" ]]; then
            echo "id must be provided" 2>&1
            exit 1
        fi
        url="http://localhost:8000/dendrite/api/jobs/$id"
        ;;
    *)
        echo "unknown table: $name" 2>&1
        exit 1
        ;;
esac

curl \
    -v \
    -u 'user:password' \
    -H 'Content-Type: application/json' \
    -XGET \
    $url
